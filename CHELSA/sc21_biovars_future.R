library(rgdal)
library(raster)
library(sp)
library(dismo)

#make sure to cd~ before running if done interactively. Sh submission script has this included. 
prec_r_1 <- raster("project/CHELSA/future/prec/uganda_clips/CHELSA_prec_1_rcp45_2041-2060_UgandaClip.tif")
prec_r_2 <- raster("project/CHELSA/future/prec/uganda_clips/CHELSA_prec_2_rcp45_2041-2060_UgandaClip.tif")
prec_r_3 <- raster("project/CHELSA/future/prec/uganda_clips/CHELSA_prec_3_rcp45_2041-2060_UgandaClip.tif")
prec_r_4 <- raster("project/CHELSA/future/prec/uganda_clips/CHELSA_prec_4_rcp45_2041-2060_UgandaClip.tif")
prec_r_5 <- raster("project/CHELSA/future/prec/uganda_clips/CHELSA_prec_5_rcp45_2041-2060_UgandaClip.tif")
prec_r_6 <- raster("project/CHELSA/future/prec/uganda_clips/CHELSA_prec_6_rcp45_2041-2060_UgandaClip.tif")
prec_r_7 <- raster("project/CHELSA/future/prec/uganda_clips/CHELSA_prec_7_rcp45_2041-2060_UgandaClip.tif")
prec_r_8 <- raster("project/CHELSA/future/prec/uganda_clips/CHELSA_prec_8_rcp45_2041-2060_UgandaClip.tif")
prec_r_9 <- raster("project/CHELSA/future/prec/uganda_clips/CHELSA_prec_9_rcp45_2041-2060_UgandaClip.tif")
prec_r_10 <- raster("project/CHELSA/future/prec/uganda_clips/CHELSA_prec_10_rcp45_2041-2060_UgandaClip.tif")
prec_r_11 <- raster("project/CHELSA/future/prec/uganda_clips/CHELSA_prec_11_rcp45_2041-2060_UgandaClip.tif")
prec_r_12 <- raster("project/CHELSA/future/prec/uganda_clips/CHELSA_prec_12_rcp45_2041-2060_UgandaClip.tif")

prec_uganda <-stack(prec_r_1,prec_r_2,prec_r_3,prec_r_4,prec_r_5,prec_r_6,prec_r_7,prec_r_8,prec_r_9,prec_r_10,prec_r_11,prec_r_12)
proj4string(prec_uganda)<-CRS("+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs")

tmax_r_1 <- raster("project/CHELSA/future/tmax/uganda_clips/CHELSA_tmax_1_rcp45_2041-2060_UgandaClip.tif")
tmax_r_2 <- raster("project/CHELSA/future/tmax/uganda_clips/CHELSA_tmax_2_rcp45_2041-2060_UgandaClip.tif")
tmax_r_3 <- raster("project/CHELSA/future/tmax/uganda_clips/CHELSA_tmax_3_rcp45_2041-2060_UgandaClip.tif")
tmax_r_4 <- raster("project/CHELSA/future/tmax/uganda_clips/CHELSA_tmax_4_rcp45_2041-2060_UgandaClip.tif")
tmax_r_5 <- raster("project/CHELSA/future/tmax/uganda_clips/CHELSA_tmax_5_rcp45_2041-2060_UgandaClip.tif")
tmax_r_6 <- raster("project/CHELSA/future/tmax/uganda_clips/CHELSA_tmax_6_rcp45_2041-2060_UgandaClip.tif")
tmax_r_7 <- raster("project/CHELSA/future/tmax/uganda_clips/CHELSA_tmax_7_rcp45_2041-2060_UgandaClip.tif")
tmax_r_8 <- raster("project/CHELSA/future/tmax/uganda_clips/CHELSA_tmax_8_rcp45_2041-2060_UgandaClip.tif")
tmax_r_9 <- raster("project/CHELSA/future/tmax/uganda_clips/CHELSA_tmax_9_rcp45_2041-2060_UgandaClip.tif")
tmax_r_10 <- raster("project/CHELSA/future/tmax/uganda_clips/CHELSA_tmax_10_rcp45_2041-2060_UgandaClip.tif")
tmax_r_11 <- raster("project/CHELSA/future/tmax/uganda_clips/CHELSA_tmax_11_rcp45_2041-2060_UgandaClip.tif")
tmax_r_12 <- raster("project/CHELSA/future/tmax/uganda_clips/CHELSA_tmax_12_rcp45_2041-2060_UgandaClip.tif")

tmax_uganda <-stack(tmax_r_1,tmax_r_2,tmax_r_3,tmax_r_4,tmax_r_5,tmax_r_6,tmax_r_7,tmax_r_8,tmax_r_9,tmax_r_10,tmax_r_11,tmax_r_12)
proj4string(tmax_uganda)<-CRS("+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs")

tmin_r_1 <- raster("project/CHELSA/future/tmin/uganda_clips/CHELSA_tmin_1_rcp45_2041-2060_UgandaClip.tif")
tmin_r_2 <- raster("project/CHELSA/future/tmin/uganda_clips/CHELSA_tmin_2_rcp45_2041-2060_UgandaClip.tif")
tmin_r_3 <- raster("project/CHELSA/future/tmin/uganda_clips/CHELSA_tmin_3_rcp45_2041-2060_UgandaClip.tif")
tmin_r_4 <- raster("project/CHELSA/future/tmin/uganda_clips/CHELSA_tmin_4_rcp45_2041-2060_UgandaClip.tif")
tmin_r_5 <- raster("project/CHELSA/future/tmin/uganda_clips/CHELSA_tmin_5_rcp45_2041-2060_UgandaClip.tif")
tmin_r_6 <- raster("project/CHELSA/future/tmin/uganda_clips/CHELSA_tmin_6_rcp45_2041-2060_UgandaClip.tif")
tmin_r_7 <- raster("project/CHELSA/future/tmin/uganda_clips/CHELSA_tmin_7_rcp45_2041-2060_UgandaClip.tif")
tmin_r_8 <- raster("project/CHELSA/future/tmin/uganda_clips/CHELSA_tmin_8_rcp45_2041-2060_UgandaClip.tif")
tmin_r_9 <- raster("project/CHELSA/future/tmin/uganda_clips/CHELSA_tmin_9_rcp45_2041-2060_UgandaClip.tif")
tmin_r_10 <- raster("project/CHELSA/future/tmin/uganda_clips/CHELSA_tmin_10_rcp45_2041-2060_UgandaClip.tif")
tmin_r_11 <- raster("project/CHELSA/future/tmin/uganda_clips/CHELSA_tmin_11_rcp45_2041-2060_UgandaClip.tif")
tmin_r_12 <- raster("project/CHELSA/future/tmin/uganda_clips/CHELSA_tmin_12_rcp45_2041-2060_UgandaClip.tif")

tmin_uganda <-stack(tmin_r_1,tmin_r_2,tmin_r_3,tmin_r_4,tmin_r_5,tmin_r_6,tmin_r_7,tmin_r_8,tmin_r_9,tmin_r_10,tmin_r_11,tmin_r_12)
proj4string(tmin_uganda)<-CRS("+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs")

biovar_uganda.future <- biovars(prec_uganda,tmin_uganda,tmax_uganda)
#repetitive definition of projection, but added in case (this line is sufficent for the output to be in the desired CRS)
proj4string(biovar_uganda.future)<-CRS("+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs")

writeRaster(biovar_uganda.future,"/home/fas/caccone/apb56/project/CHELSA/biovars/UgandaBiovarsFuture",format="GTiff")
